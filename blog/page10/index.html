<!DOCTYPE html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#b100b2><meta name=theme-color content=#b100b2><meta property=og:url content=https://martinjc.com/ ><meta property=og:type content=website><meta property=og:title content="Martin Chorley"><meta property=og:description content="I am Dr Martin Chorley, a Senior Lecturer at the School of Computer Science & Informatics, Cardiff University, programme leader for the MSc in Computational and Data Journalism.
"><meta property=og:site_name content="Martin Chorley"><meta property=og:locale content=en_GB><meta property=article:author content="Martin Chorley"><meta name=twitter:card content=summary><meta name=twitter:creator content=@martinjc><meta name=twitter:url content=https://martinjc.com><meta name=twitter:title content="Martin Chorley"><meta name=twitter:description content="I am Dr Martin Chorley, a Senior Lecturer at the School of Computer Science & Informatics, Cardiff University, programme leader for the MSc in Computational and Data Journalism.
"><title>martinjc.com</title><meta name=description content="I am Dr Martin Chorley, a Senior Lecturer at the School of Computer Science & Informatics, Cardiff University, programme leader for the MSc in Computational and Data Journalism.
"><link rel=icon href=/img/favicon.png><link href="https://fonts.googleapis.com/css?family=Roboto|Scope+One" rel=stylesheet><link rel=stylesheet type=text/css href=/css/main.css></head><body><header><div class=social><ul><li><a href=https://www.twitter.com/martinjc class="icon twitter" title=Twitter><svg viewBox="0 0 512 512"><path d="M419.6 168.6c-11.7 5.2-24.2 8.7-37.4 10.2 13.4-8.1 23.8-20.8 28.6-36 -12.6 7.5-26.5 12.9-41.3 15.8 -11.9-12.6-28.8-20.6-47.5-20.6 -42 0-72.9 39.2-63.4 79.9 -54.1-2.7-102.1-28.6-134.2-68 -17 29.2-8.8 67.5 20.1 86.9 -10.7-0.3-20.7-3.3-29.5-8.1 -0.7 30.2 20.9 58.4 52.2 64.6 -9.2 2.5-19.2 3.1-29.4 1.1 8.3 25.9 32.3 44.7 60.8 45.2 -27.4 21.4-61.8 31-96.4 27 28.8 18.5 63 29.2 99.8 29.2 120.8 0 189.1-102.1 185-193.6C399.9 193.1 410.9 181.7 419.6 168.6z"/></svg><!--[if lt IE 9]><em>Twitter</em><![endif]--></a></li><li><a href=mailto:ChorleyMJ@Cardiff.ac.uk class="icon email" title=Email><svg viewBox="0 0 512 512"><path d="M101.3 141.6v228.9h0.3 308.4 0.8V141.6H101.3zM375.7 167.8l-119.7 91.5 -119.6-91.5H375.7zM127.6 194.1l64.1 49.1 -64.1 64.1V194.1zM127.8 344.2l84.9-84.9 43.2 33.1 43-32.9 84.7 84.7L127.8 344.2 127.8 344.2zM384.4 307.8l-64.4-64.4 64.4-49.3V307.8z"/></svg><!--[if lt IE 9]><em>Email</em><![endif]--></a></li><li><a href=https://www.facebook.com/martin.chorley class="icon facebook" title=Facebook><svg viewBox="0 0 512 512"><path d="M211.9 197.4h-36.7v59.9h36.7V433.1h70.5V256.5h49.2l5.2-59.1h-54.4c0 0 0-22.1 0-33.7 0-13.9 2.8-19.5 16.3-19.5 10.9 0 38.2 0 38.2 0V82.9c0 0-40.2 0-48.8 0 -52.5 0-76.1 23.1-76.1 67.3C211.9 188.8 211.9 197.4 211.9 197.4z"/></svg><!--[if lt IE 9]><em>Facebook</em><![endif]--></a></li><li><a href=https://www.github.com/martinjc class="icon github" title=GitHub><svg viewBox="0 0 512 512"><path d="M256 70.7c-102.6 0-185.9 83.2-185.9 185.9 0 82.1 53.3 151.8 127.1 176.4 9.3 1.7 12.3-4 12.3-8.9V389.4c-51.7 11.3-62.5-21.9-62.5-21.9 -8.4-21.5-20.6-27.2-20.6-27.2 -16.9-11.5 1.3-11.3 1.3-11.3 18.7 1.3 28.5 19.2 28.5 19.2 16.6 28.4 43.5 20.2 54.1 15.4 1.7-12 6.5-20.2 11.8-24.9 -41.3-4.7-84.7-20.6-84.7-91.9 0-20.3 7.3-36.9 19.2-49.9 -1.9-4.7-8.3-23.6 1.8-49.2 0 0 15.6-5 51.1 19.1 14.8-4.1 30.7-6.2 46.5-6.3 15.8 0.1 31.7 2.1 46.6 6.3 35.5-24 51.1-19.1 51.1-19.1 10.1 25.6 3.8 44.5 1.8 49.2 11.9 13 19.1 29.6 19.1 49.9 0 71.4-43.5 87.1-84.9 91.7 6.7 5.8 12.8 17.1 12.8 34.4 0 24.9 0 44.9 0 51 0 4.9 3 10.7 12.4 8.9 73.8-24.6 127-94.3 127-176.4C441.9 153.9 358.6 70.7 256 70.7z"/></svg><!--[if lt IE 9]><em>GitHub</em><![endif]--></a></li><li><a href=https://www.instagram.com/martinjam class="icon instagram" title=Instagram><svg viewBox="0 0 512 512"><g><path d="M256 109.3c47.8 0 53.4 0.2 72.3 1 17.4 0.8 26.9 3.7 33.2 6.2 8.4 3.2 14.3 7.1 20.6 13.4 6.3 6.3 10.1 12.2 13.4 20.6 2.5 6.3 5.4 15.8 6.2 33.2 0.9 18.9 1 24.5 1 72.3s-0.2 53.4-1 72.3c-0.8 17.4-3.7 26.9-6.2 33.2 -3.2 8.4-7.1 14.3-13.4 20.6 -6.3 6.3-12.2 10.1-20.6 13.4 -6.3 2.5-15.8 5.4-33.2 6.2 -18.9 0.9-24.5 1-72.3 1s-53.4-0.2-72.3-1c-17.4-0.8-26.9-3.7-33.2-6.2 -8.4-3.2-14.3-7.1-20.6-13.4 -6.3-6.3-10.1-12.2-13.4-20.6 -2.5-6.3-5.4-15.8-6.2-33.2 -0.9-18.9-1-24.5-1-72.3s0.2-53.4 1-72.3c0.8-17.4 3.7-26.9 6.2-33.2 3.2-8.4 7.1-14.3 13.4-20.6 6.3-6.3 12.2-10.1 20.6-13.4 6.3-2.5 15.8-5.4 33.2-6.2C202.6 109.5 208.2 109.3 256 109.3M256 77.1c-48.6 0-54.7 0.2-73.8 1.1 -19 0.9-32.1 3.9-43.4 8.3 -11.8 4.6-21.7 10.7-31.7 20.6 -9.9 9.9-16.1 19.9-20.6 31.7 -4.4 11.4-7.4 24.4-8.3 43.4 -0.9 19.1-1.1 25.2-1.1 73.8 0 48.6 0.2 54.7 1.1 73.8 0.9 19 3.9 32.1 8.3 43.4 4.6 11.8 10.7 21.7 20.6 31.7 9.9 9.9 19.9 16.1 31.7 20.6 11.4 4.4 24.4 7.4 43.4 8.3 19.1 0.9 25.2 1.1 73.8 1.1s54.7-0.2 73.8-1.1c19-0.9 32.1-3.9 43.4-8.3 11.8-4.6 21.7-10.7 31.7-20.6 9.9-9.9 16.1-19.9 20.6-31.7 4.4-11.4 7.4-24.4 8.3-43.4 0.9-19.1 1.1-25.2 1.1-73.8s-0.2-54.7-1.1-73.8c-0.9-19-3.9-32.1-8.3-43.4 -4.6-11.8-10.7-21.7-20.6-31.7 -9.9-9.9-19.9-16.1-31.7-20.6 -11.4-4.4-24.4-7.4-43.4-8.3C310.7 77.3 304.6 77.1 256 77.1L256 77.1z"/><path d="M256 164.1c-50.7 0-91.9 41.1-91.9 91.9s41.1 91.9 91.9 91.9 91.9-41.1 91.9-91.9S306.7 164.1 256 164.1zM256 315.6c-32.9 0-59.6-26.7-59.6-59.6s26.7-59.6 59.6-59.6 59.6 26.7 59.6 59.6S288.9 315.6 256 315.6z"/><circle cx=351.5 cy=160.5 r=21.5 /></g></svg><!--[if lt IE 9]><em>Instagram</em><![endif]--></a></li><li><a href=https://www.last.fm/user/takitomouse class="icon lastfm" title=Last.fm><svg viewBox="0 0 512 512"><path d="M230.104 336.568l-13.607-36.988c0 0-22.11 24.66-55.268 24.66 -29.341 0-50.172-25.512-50.172-66.328 0-52.293 26.359-71.001 52.297-71.001 37.412 0 49.316 24.234 59.522 55.273l13.607 42.518c13.603 41.236 39.113 74.402 112.666 74.402 52.727 0 88.437-16.155 88.437-58.672 0-34.438-19.56-52.297-56.125-60.802l-27.209-5.951c-18.707-4.252-24.233-11.906-24.233-24.659 0-14.456 11.478-22.96 30.189-22.96 20.406 0 31.458 7.653 33.162 25.935l42.516-5.103c-3.402-38.263-29.761-53.996-73.127-53.996 -38.266 0-75.68 14.456-75.68 60.799 0 28.912 14.029 47.197 49.315 55.697l28.916 6.801c21.683 5.104 28.908 14.031 28.908 26.363 0 15.73-15.305 22.107-44.218 22.107 -42.941 0-60.794-22.534-70.999-53.574l-14.032-42.513c-17.854-55.271-46.342-75.68-102.892-75.68 -62.499-0.001-95.663 39.538-95.663 106.715 0 64.628 33.164 99.489 92.689 99.489C207.141 359.1 230.104 336.568 230.104 336.568L230.104 336.568z"/></svg><!--[if lt IE 9]><em>Last.fm</em><![endif]--></a></li><li><a href=https://uk.linkedin.com/in/martinchorley class="icon linkedin" title=LinkedIn><svg viewBox="0 0 512 512"><path d="M186.4 142.4c0 19-15.3 34.5-34.2 34.5 -18.9 0-34.2-15.4-34.2-34.5 0-19 15.3-34.5 34.2-34.5C171.1 107.9 186.4 123.4 186.4 142.4zM181.4 201.3h-57.8V388.1h57.8V201.3zM273.8 201.3h-55.4V388.1h55.4c0 0 0-69.3 0-98 0-26.3 12.1-41.9 35.2-41.9 21.3 0 31.5 15 31.5 41.9 0 26.9 0 98 0 98h57.5c0 0 0-68.2 0-118.3 0-50-28.3-74.2-68-74.2 -39.6 0-56.3 30.9-56.3 30.9v-25.2H273.8z"/></svg><!--[if lt IE 9]><em>LinkedIn</em><![endif]--></a></li></ul></div><nav><ul>|<li><a href=/ >&nbsp;home</a>&nbsp;|</li><li><a href=/blog>&nbsp;blog</a>&nbsp;|</li><li><a href=/teaching>&nbsp;teaching</a>&nbsp;|</li><li><a href=/research>&nbsp;research</a>&nbsp;|</li><li><a href=/publications>&nbsp;publications</a>&nbsp;|</li></ul></nav></header><div class=wrapper><article class=blogpost><header><h1><a href=/2013/08/18/swn-festival-2013-plans-part-1-the-data-2.html>SWN Festival 2013 plans – part 1: the data (2!)</a></h1><p class=author><span class=date>August 18, 2013</span> - by martin</p></header><div class=content><p>In the previous post, I used python and BeautifulSoup to grab the list of artists appearing at <a href=http://www.swnfest.com>SWN Festival 2013</a>, and to scrape their associated soundcloud/twitter/facebook/youtube links (where available).</p><p>However, there are more places to find music online than just those listed on the festival site, and some of those extra sources include additional data that I want to collect, so now we need to search these other sources for the artists. Firstly, we need to load the artist data we previously extracted from the festival website, and iterate through the list of artists one by one:</p><figure class=highlight><pre><code class=language-python data-lang=python><span class=n>artists</span> <span class=o>=</span> <span class=p>{}</span>
<span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s>"bands.json"</span><span class=p>)</span> <span class=k>as</span> <span class=n>infile</span><span class=p>:</span>
    <span class=n>artists</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>infile</span><span class=p>)</span>

<span class=k>for</span> <span class=n>artist</span><span class=p>,</span> <span class=n>artist_data</span> <span class=ow>in</span> <span class=n>artists</span><span class=o>.</span><span class=n>iteritems</span><span class=p>():</span></code></pre></figure><p>The first thing I want to do for each artist it to search Spotify to see if they have any music available there. Spotify has a simple web <a href=https://developer.spotify.com/technologies/web-api/ >API</a> for searching which is pretty straightforward to use:</p><figure class=highlight><pre><code class=language-python data-lang=python><span class=n>params</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s>"q"</span> <span class=p>:</span> <span class=s>"artist:"</span> <span class=o>+</span> <span class=n>artist</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s>"utf-8"</span><span class=p>)</span>
<span class=p>}</span>

<span class=n>spotify_root_url</span> <span class=o>=</span> <span class=s>"http://ws.spotify.com/search/1/artist.json"</span>
<span class=n>spotify_url</span> <span class=o>=</span> <span class=s>"</span><span class=si>%</span><span class=s>s?</span><span class=si>%</span><span class=s>s"</span> <span class=o>%</span> <span class=p>(</span><span class=n>spotify_root_url</span><span class=p>,</span> <span class=n>urllib</span><span class=o>.</span><span class=n>urlencode</span><span class=p>(</span><span class=n>params</span><span class=p>))</span>

<span class=n>data</span> <span class=o>=</span> <span class=n>retrieve_json_data</span><span class=p>(</span><span class=n>spotify_url</span><span class=p>)</span>

<span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s>"artists"</span><span class=p>,</span> <span class=bp>None</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=bp>None</span><span class=p>:</span>
    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s>"artists"</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
        <span class=n>artist_id</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s>"artists"</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=s>"href"</span><span class=p>]</span><span class=o>.</span><span class=n>lstrip</span><span class=p>(</span><span class=s>"spotify:artist:"</span><span class=p>)</span>
        <span class=n>artist_data</span><span class=p>[</span><span class=s>"spotify_id"</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s>"artists"</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=s>"href"</span><span class=p>]</span>
        <span class=n>artist_data</span><span class=p>[</span><span class=s>"spotify_url"</span><span class=p>]</span> <span class=o>=</span> <span class=s>"http://open.spotify.com/artist/"</span> <span class=o>+</span> <span class=n>artist_id</span></code></pre></figure><p>The ‘retrieve_json_data’ function is just a wrapper to call a URL and parse the returned JSON data:</p><figure class=highlight><pre><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>retrieve_json_data</span><span class=p>(</span><span class=n>url</span><span class=p>):</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>response</span> <span class=o>=</span> <span class=n>urllib2</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
    <span class=k>except</span> <span class=n>urllib2</span><span class=o>.</span><span class=n>HTTPError</span><span class=p>,</span> <span class=n>e</span><span class=p>:</span>
        <span class=k>raise</span> <span class=n>e</span>
    <span class=k>except</span> <span class=n>urllib2</span><span class=o>.</span><span class=n>URLError</span><span class=p>,</span> <span class=n>e</span><span class=p>:</span>
        <span class=k>raise</span> <span class=n>e</span>

    <span class=n>raw_data</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
    <span class=n>data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>raw_data</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>data</span></code></pre></figure><p>Once I’ve searched Spotify, I then want to see if the artist has a page on Last.FM. If they do, I also want to extract and store their top-tags from the site. Again, the Last.FM API makes this straightforward. Firstly, searching for the artist page:</p><figure class=highlight><pre><code class=language-python data-lang=python><span class=n>params</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s>"artist"</span><span class=p>:</span> <span class=n>artist</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s>"utf-8"</span><span class=p>),</span>
    <span class=s>"api_key"</span><span class=p>:</span> <span class=n>last_fm_api_key</span><span class=p>,</span>
    <span class=s>"method"</span><span class=p>:</span> <span class=s>"artist.getinfo"</span><span class=p>,</span>
    <span class=s>"format"</span><span class=p>:</span> <span class=s>"json"</span>
<span class=p>}</span>

<span class=n>last_fm_url</span> <span class=o>=</span> <span class=s>"http://ws.audioscrobbler.com/2.0/?"</span> <span class=o>+</span> <span class=n>urllib</span><span class=o>.</span><span class=n>urlencode</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>

<span class=n>data</span> <span class=o>=</span> <span class=n>retrieve_json_data</span><span class=p>(</span><span class=n>last_fm_url</span><span class=p>)</span>

<span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s>"artist"</span><span class=p>,</span> <span class=bp>None</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=bp>None</span><span class=p>:</span>
    <span class=k>if</span> <span class=n>data</span><span class=p>[</span><span class=s>"artist"</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s>"url"</span><span class=p>,</span> <span class=bp>None</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=bp>None</span><span class=p>:</span>
        <span class=n>artist_data</span><span class=p>[</span><span class=s>"last_fm_url"</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s>"artist"</span><span class=p>][</span><span class=s>"url"</span><span class=p>]</span></code></pre></figure><p>Then, searching for the artist’s top tags:</p><figure class=highlight><pre><code class=language-python data-lang=python><span class=n>params</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s>"artist"</span><span class=p>:</span> <span class=n>artist</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s>"utf-8"</span><span class=p>),</span>
    <span class=s>"api_key"</span><span class=p>:</span> <span class=n>last_fm_api_key</span><span class=p>,</span>
    <span class=s>"method"</span><span class=p>:</span> <span class=s>"artist.gettoptags"</span><span class=p>,</span>
    <span class=s>"format"</span><span class=p>:</span> <span class=s>"json"</span>
<span class=p>}</span>

<span class=n>last_fm_url</span> <span class=o>=</span> <span class=s>"http://ws.audioscrobbler.com/2.0/?"</span> <span class=o>+</span> <span class=n>urllib</span><span class=o>.</span><span class=n>urlencode</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>

<span class=n>data</span> <span class=o>=</span> <span class=n>retrieve_json_data</span><span class=p>(</span><span class=n>last_fm_url</span><span class=p>)</span>

<span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s>"toptags"</span><span class=p>,</span> <span class=bp>None</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=bp>None</span><span class=p>:</span>

    <span class=n>artist_data</span><span class=p>[</span><span class=s>"tags"</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>

    <span class=k>if</span> <span class=n>data</span><span class=p>[</span><span class=s>"toptags"</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s>"tag"</span><span class=p>,</span> <span class=bp>None</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=bp>None</span><span class=p>:</span>
        <span class=n>tags</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s>"toptags"</span><span class=p>][</span><span class=s>"tag"</span><span class=p>]</span>
        <span class=k>if</span> <span class=nb>type</span><span class=p>(</span><span class=n>tags</span><span class=p>)</span> <span class=o>==</span> <span class=nb>type</span><span class=p>([]):</span>
            <span class=k>for</span> <span class=n>tag</span> <span class=ow>in</span> <span class=n>tags</span><span class=p>:</span>
                <span class=n>name</span> <span class=o>=</span> <span class=n>tag</span><span class=p>[</span><span class=s>"name"</span><span class=p>]</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s>'utf-8'</span><span class=p>)</span>
                <span class=n>count</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>tag</span><span class=p>[</span><span class=s>"count"</span><span class=p>])</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=nb>int</span><span class=p>(</span><span class=n>tag</span><span class=p>[</span><span class=s>"count"</span><span class=p>])</span>
                <span class=n>artist_data</span><span class=p>[</span><span class=s>"tags"</span><span class=p>][</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>count</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>name</span> <span class=o>=</span> <span class=n>tags</span><span class=p>[</span><span class=s>"name"</span><span class=p>]</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s>'utf-8'</span><span class=p>)</span>
                <span class=n>count</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>tags</span><span class=p>[</span><span class=s>"count"</span><span class=p>])</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=nb>int</span><span class=p>(</span><span class=n>tags</span><span class=p>[</span><span class=s>"count"</span><span class=p>])</span>
                <span class=n>artist_data</span><span class=p>[</span><span class=s>"tags"</span><span class=p>][</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>count</span></code></pre></figure><p>Again, once we’ve retrieved all the extra artist data, we can dump it to file:</p><figure class=highlight><pre><code class=language-python data-lang=python><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s>"bands.json"</span><span class=p>,</span> <span class=s>"w"</span><span class=p>)</span> <span class=k>as</span> <span class=n>outfile</span><span class=p>:</span>
    <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>artists</span><span class=p>,</span> <span class=n>outfile</span><span class=p>)</span></code></pre></figure><p>So, I now have 2 scripts that I can run regularly to capture any updates to the festival website (including lineup additions) and to search for artist data on Spotify and Last.FM. Now I’ve got all this data captured and stored, it’s time to start doing something interesting with it…</p></div></article><hr><article class=blogpost><header><h1><a href=/2013/08/16/epsrc-doctoral-award-fellowship.html>EPSRC Doctoral Award Fellowship</a></h1><p class=author><span class=date>August 16, 2013</span> - by martin</p></header><div class=content><p>I’m really very pleased to be able to say that I have been awarded a 2013 EPSRC doctoral award fellowship. This means I’ve been given an opportunity to spend 12 months from October this year working independently on a research project of my own choosing. I’ll be looking at the connection between places and personality, analysing the large dataset collected through the <a href=http://www.cs.cf.ac.uk/recognition/foursqexp/ >Foursquare Personality</a> app to try and build towards a recommendation system for places that uses personality as one of its key input signals.</p><p>I think this is a really interesting research project, and I’m hoping for some good results. The basic question I’m asking is: if we know where someone has been (i.e. from their Foursquare history) then can we predict what their personality is? If we can do that, then maybe we can do the reverse, and from someone’s personality, infer where they might like to go. This could lead to a shift in the way that place recommendation systems are built, utilising not just the knowledge of <em>where</em> someone has been, but also <em>why</em> someone has been there.</p><p>This is a great opportunity -  while it has been really good to work on the last two EU projects I’ve been involved in, the overheads (especially the deliverables) have sometimes been a distraction and have sometimes gotten in the way of the research. With this project I’ll be able to plough on with the research without having to worry about those kinds of administrative overheads. It’s also a great stepping stone on my academic career path, and should give me the opportunity to generate some high quality outputs that will help with moving on to the next stage.</p></div></article><hr><article class=blogpost><header><h1><a href=/2013/08/14/swn-festival-2013-plans-part-1-the-data.html>SWN Festival 2013 plans - part 1: the data</a></h1><p class=author><span class=date>August 14, 2013</span> - by martin</p></header><div class=content><p>As <a href=https://martinjc.com/2013/08/11/swn-festival-2013-plans/ >I mentioned</a>, I’m planning on doing a bit more development work this year connected to the <a href=http://www.swnfest.com>SWN Festival</a>. The first stage is to get hold of the data associated with the festival in an accessible and machine readable form so it can be used in other apps.</p><p>Unfortunately (but unsurprisingly), being a smallish local festival, there is no API for any of the data. So, getting a list of the bands and their info means we need to resort to web scraping. Fortunately, with a couple of lines of python and the BeautifulSoup library, getting the list of artists playing the festival is pretty straightforward:</p><figure class=highlight><pre><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>urllib2</span>
<span class=kn>import</span> <span class=nn>json</span>

<span class=kn>from</span> <span class=nn>bs4</span> <span class=kn>import</span> <span class=n>BeautifulSoup</span>
<span class=n>root_page</span> <span class=o>=</span> <span class=s>"http://swnfest.com/"</span>
<span class=n>lineup_page</span> <span class=o>=</span> <span class=n>root_page</span> <span class=o>+</span> <span class=s>"lineup/"</span>

<span class=k>try</span><span class=p>:</span>
    <span class=n>response</span> <span class=o>=</span> <span class=n>urllib2</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=n>lineup_page</span><span class=p>)</span>
<span class=k>except</span> <span class=n>urllib2</span><span class=o>.</span><span class=n>HTTPError</span><span class=p>,</span> <span class=n>e</span><span class=p>:</span>
    <span class=k>raise</span> <span class=n>e</span>
<span class=k>except</span> <span class=n>urllib2</span><span class=o>.</span><span class=n>URLError</span><span class=p>,</span> <span class=n>e</span><span class=p>:</span>
    <span class=k>raise</span> <span class=n>e</span>

<span class=n>raw_data</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>

<span class=n>soup</span> <span class=o>=</span> <span class=n>BeautifulSoup</span><span class=p>(</span><span class=n>raw_data</span><span class=p>)</span>

<span class=n>links</span> <span class=o>=</span> <span class=n>soup</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=s>".artist-listing h5 a"</span><span class=p>)</span>

<span class=n>artists</span> <span class=o>=</span> <span class=p>{}</span>

<span class=k>for</span> <span class=n>link</span> <span class=ow>in</span> <span class=n>links</span><span class=p>:</span>
    <span class=n>url</span> <span class=o>=</span> <span class=n>link</span><span class=o>.</span><span class=n>attrs</span><span class=p>[</span><span class=s>"href"</span><span class=p>]</span>
    <span class=n>artist</span> <span class=o>=</span> <span class=n>link</span><span class=o>.</span><span class=n>contents</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>

    <span class=n>artists</span><span class=p>[</span><span class=n>artist</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=n>artists</span><span class=p>[</span><span class=n>artist</span><span class=p>][</span><span class=s>"swn_url"</span><span class=p>]</span> <span class=o>=</span> <span class=n>url</span></code></pre></figure><p>All we’re doing here is loading the <a href=http://swnfest.com/lineup/ >lineup</a> page for the main festival website, using BeautifulSoup to find all the links to individual artist pages (which are in a div with a class of “artist-listing”, each one in a h5 tag), then parsing these links to extract the artist name, and the url of their page on the festival website.</p><p>Each artist page on the website includes handy links to soundcloud, twitter, youtube etc (where these exist), and since I’m going to want to include these kinds of things in the apps I’m working on, I’ll grab those too:</p><figure class=highlight><pre><code class=language-python data-lang=python><span class=k>for</span> <span class=n>artist</span><span class=p>,</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>artists</span><span class=o>.</span><span class=n>iteritems</span><span class=p>():</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>response</span> <span class=o>=</span> <span class=n>urllib2</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s>"swn_url"</span><span class=p>])</span>
    <span class=k>except</span> <span class=n>urllib2</span><span class=o>.</span><span class=n>HTTPError</span><span class=p>,</span> <span class=n>e</span><span class=p>:</span>
        <span class=k>raise</span> <span class=n>e</span>
    <span class=k>except</span> <span class=n>urllib2</span><span class=o>.</span><span class=n>URLError</span><span class=p>,</span> <span class=n>e</span><span class=p>:</span>
        <span class=k>raise</span> <span class=n>e</span>

    <span class=n>raw_data</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>

    <span class=n>soup</span> <span class=o>=</span> <span class=n>BeautifulSoup</span><span class=p>(</span><span class=n>raw_data</span><span class=p>)</span>

    <span class=n>links</span> <span class=o>=</span> <span class=n>soup</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=s>".outlinks li"</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>link</span> <span class=ow>in</span> <span class=n>links</span><span class=p>:</span>
         <span class=n>source_name</span> <span class=o>=</span> <span class=n>link</span><span class=o>.</span><span class=n>attrs</span><span class=p>[</span><span class=s>"class"</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
         <span class=n>source_url</span> <span class=o>=</span> <span class=n>link</span><span class=o>.</span><span class=n>findChild</span><span class=p>(</span><span class=s>"a"</span><span class=p>)</span><span class=o>.</span><span class=n>attrs</span><span class=p>[</span><span class=s>"href"</span><span class=p>]</span>
         <span class=n>data</span><span class=p>[</span><span class=n>source_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>source_url</span></code></pre></figure><p>This code iterates through the list of artists we just extracted from the lineup page, retrieves the relevant artist page, and parses it for the outgoing links, stored in list items in an unordered list with a class of ‘outlinks’. Fortunately each link in this list has a class describing what type of link it is (facebook/twitter/soundcloud etc) so we can use the class as a key in our dictionary, with the link itself as an item. Later on once schedule information is included in the artist page we can add some code to parse stage-times and venues, but at the moment that data isn’t present on the pages, so we can’t extract it yet.</p><p>Finally we can just dump our artist data to json, and we have the information we need in an easily accessible format:</p><figure class=highlight><pre><code class=language-python data-lang=python><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s>"bands.json"</span><span class=p>,</span> <span class=s>"w"</span><span class=p>)</span> <span class=k>as</span> <span class=n>outfile</span><span class=p>:</span>
    <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>artists</span><span class=p>,</span> <span class=n>outfile</span><span class=p>)</span></code></pre></figure><p>Now we have the basic data for each artist, we can go on to search for more information on other music sites. The nice thing about this script is that when the lineup gets updated, we can just re-run the code and capture all the new artists that have been added. I should also mention that all the code I’m using for this is available on <a href=https://github.com/martinjc/swnScraper2013>github</a>.</p></div></article><hr><article class=blogpost><header><h1><a href=/2013/08/11/swn-festival-2013-plans.html>SWN Festival 2013 - plans</a></h1><p class=author><span class=date>August 11, 2013</span> - by martin</p></header><div class=content><p>Last year I had a go at creating a couple of web apps based around the bands playing the <a href=http://www.swnfest.com>SWN Festival</a> here in Cardiff. I love SWN with all my heart, it’s a permanent fixture in my calendar and even if (when) I leave Cardiff it’ll be the one thing I come back for every year. It’s a great way to see and discover new bands, but sometimes the sheer volume of music on offer can be overwhelming. So I wanted to see if I could create some web apps that would help to navigate your way through all the bands, and find the ones that you should go and see.</p><p>The <a href=https://martinjc.com/swn/2012/tags/ >first</a> was a simple app that gathered artist tags from Last.FM, allowing you to see which artists playing the festival had similar tags - so if you knew you liked one artist you could find other artists tagged with the same terms. The <a href=https://martinjc.com/swn/2012/rec/ >second</a> (which technically wasn’t ever really finished) would allow you to login with a last.fm account and find the artists whose tags best matched the tags for your top artists in your last.fm profile.</p><p>I liked both these apps and found them both useful - but I don’t think they went far enough. I only started development late in the year, about a month before the festival, so didn’t have a lot of time to really get into it. This year I’m starting a lot earlier, so I’ve got time to do a lot more.</p><p>Firstly I’d like to repeat the apps from last year, but perhaps combining them in some way. I’d like to include more links to the actual music, making it easy to get from an artist to their songs by including embeds from soundcloud, spotify, youtube etc. I’d also like to try making a mobile app guide to the festival (probably as an android app as the official app is iOS only). I’m hopeful that given enough free time I should be able to get some genuinely useful stuff done, and I’ll be blogging about it here as I work on it.</p></div></article><hr><article class=blogpost><header><h1><a href=/2013/07/25/summer-project-update.html>Summer Project update</a></h1><p class=author><span class=date>July 25, 2013</span> - by martin</p></header><div class=content><p>We are storming along with <a href=https://martinjc.com/research/student-projects/ >summer projects</a> now, and starting to see some really good results.</p><p>Liam Turner (who is starting a PhD in the school in October) has been working hard to create a mobile version of the <a href=http://www.cs.cf.ac.uk/recognition/foursqexp/ >4SQPersonality</a> app. His work is coming along really well, with a great mobile HTML version now up and running, a native android wrapper working, and an iOS wrapper on its way. With any luck we’ll have mobile apps for both major platforms ready to be released before the summer is over.</p><p>Max Chandler, who is now a second year undergraduate, has done some great work looking at the Foursquare venues within various cities around the UK, analysing them for similarity and spatial distribution. He’s just over halfway through the project now and is beginning to work on visualising the data he’s collected and analysed. He’s creating some interesting interactive visualisations using <a href=http://d3js.org/ >D3</a>, so as soon as he’s done I’ll link to the website here.</p><p>It’s been a really good summer for student projects so far, with some really pleasing results. I’ll post more description of the projects and share some of the results as they come to a close in the coming weeks.</p></div></article><hr><div class=pagination><a href=/blog/page9 class=previous>Previous</a> <span class=page_number>Page: 10 of 22</span> <a href=/blog/page11 class=next>Next</a></div></div><script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-25500481-1","auto"),ga("send","pageview")</script><script>window.twttr=function(t,e,r){var n,i=t.getElementsByTagName(e)[0],w=window.twttr||{};return t.getElementById(r)?w:(n=t.createElement(e),n.id=r,n.src="https://platform.twitter.com/widgets.js",i.parentNode.insertBefore(n,i),w._e=[],w.ready=function(t){w._e.push(t)},w)}(document,"script","twitter-wjs")</script></body></html>