<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#b100b2">
    <meta name="theme-color" content="#b100b2">

    <meta property="og:url" content="https://martinjc.com/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Martin Chorley">
    <meta property="og:site_name" content="Martin Chorley">
    <meta property="og:locale" content="en_GB">
    <meta property="article:author" content="Martin Chorley">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="@martinjc">
    <meta name="twitter:url" content="https://martinjc.com">
    <meta name="twitter:title" content="Martin Chorley">

    <link rel="icon" href="/img/favicon.png">
    <link href="https://fonts.googleapis.com/css?family=Roboto|Scope+One" rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css">
</head><body><header>
    <div class="social">
        <ul>
            <li><a href="https://www.twitter.com/martinjc" class="icon twitter" title="Twitter"><svg viewBox="0 0 512 512">
                        <path d="M419.6 168.6c-11.7 5.2-24.2 8.7-37.4 10.2 13.4-8.1 23.8-20.8 28.6-36 -12.6 7.5-26.5 12.9-41.3 15.8 -11.9-12.6-28.8-20.6-47.5-20.6 -42 0-72.9 39.2-63.4 79.9 -54.1-2.7-102.1-28.6-134.2-68 -17 29.2-8.8 67.5 20.1 86.9 -10.7-0.3-20.7-3.3-29.5-8.1 -0.7 30.2 20.9 58.4 52.2 64.6 -9.2 2.5-19.2 3.1-29.4 1.1 8.3 25.9 32.3 44.7 60.8 45.2 -27.4 21.4-61.8 31-96.4 27 28.8 18.5 63 29.2 99.8 29.2 120.8 0 189.1-102.1 185-193.6C399.9 193.1 410.9 181.7 419.6 168.6z" /></svg>
                    </a></li>
            <li><a href="mailto:ChorleyMJ@Cardiff.ac.uk" class="icon email" title="Email"><svg viewBox="0 0 512 512">
                        <path d="M101.3 141.6v228.9h0.3 308.4 0.8V141.6H101.3zM375.7 167.8l-119.7 91.5 -119.6-91.5H375.7zM127.6 194.1l64.1 49.1 -64.1 64.1V194.1zM127.8 344.2l84.9-84.9 43.2 33.1 43-32.9 84.7 84.7L127.8 344.2 127.8 344.2zM384.4 307.8l-64.4-64.4 64.4-49.3V307.8z" /></svg>
                    </a></li>
            <li><a href="https://www.facebook.com/martin.chorley" class="icon facebook" title="Facebook"><svg viewBox="0 0 512 512">
                        <path d="M211.9 197.4h-36.7v59.9h36.7V433.1h70.5V256.5h49.2l5.2-59.1h-54.4c0 0 0-22.1 0-33.7 0-13.9 2.8-19.5 16.3-19.5 10.9 0 38.2 0 38.2 0V82.9c0 0-40.2 0-48.8 0 -52.5 0-76.1 23.1-76.1 67.3C211.9 188.8 211.9 197.4 211.9 197.4z" /></svg>
                    </a></li>
            <li><a href="https://www.github.com/martinjc" class="icon github" title="GitHub"><svg viewBox="0 0 512 512">
                        <path d="M256 70.7c-102.6 0-185.9 83.2-185.9 185.9 0 82.1 53.3 151.8 127.1 176.4 9.3 1.7 12.3-4 12.3-8.9V389.4c-51.7 11.3-62.5-21.9-62.5-21.9 -8.4-21.5-20.6-27.2-20.6-27.2 -16.9-11.5 1.3-11.3 1.3-11.3 18.7 1.3 28.5 19.2 28.5 19.2 16.6 28.4 43.5 20.2 54.1 15.4 1.7-12 6.5-20.2 11.8-24.9 -41.3-4.7-84.7-20.6-84.7-91.9 0-20.3 7.3-36.9 19.2-49.9 -1.9-4.7-8.3-23.6 1.8-49.2 0 0 15.6-5 51.1 19.1 14.8-4.1 30.7-6.2 46.5-6.3 15.8 0.1 31.7 2.1 46.6 6.3 35.5-24 51.1-19.1 51.1-19.1 10.1 25.6 3.8 44.5 1.8 49.2 11.9 13 19.1 29.6 19.1 49.9 0 71.4-43.5 87.1-84.9 91.7 6.7 5.8 12.8 17.1 12.8 34.4 0 24.9 0 44.9 0 51 0 4.9 3 10.7 12.4 8.9 73.8-24.6 127-94.3 127-176.4C441.9 153.9 358.6 70.7 256 70.7z" /></svg>
                    </a></li>
            <li><a href="https://www.instagram.com/martinjam" class="icon instagram" title="Instagram"><svg viewBox="0 0 512 512">
                        <g>
                            <path d="M256 109.3c47.8 0 53.4 0.2 72.3 1 17.4 0.8 26.9 3.7 33.2 6.2 8.4 3.2 14.3 7.1 20.6 13.4 6.3 6.3 10.1 12.2 13.4 20.6 2.5 6.3 5.4 15.8 6.2 33.2 0.9 18.9 1 24.5 1 72.3s-0.2 53.4-1 72.3c-0.8 17.4-3.7 26.9-6.2 33.2 -3.2 8.4-7.1 14.3-13.4 20.6 -6.3 6.3-12.2 10.1-20.6 13.4 -6.3 2.5-15.8 5.4-33.2 6.2 -18.9 0.9-24.5 1-72.3 1s-53.4-0.2-72.3-1c-17.4-0.8-26.9-3.7-33.2-6.2 -8.4-3.2-14.3-7.1-20.6-13.4 -6.3-6.3-10.1-12.2-13.4-20.6 -2.5-6.3-5.4-15.8-6.2-33.2 -0.9-18.9-1-24.5-1-72.3s0.2-53.4 1-72.3c0.8-17.4 3.7-26.9 6.2-33.2 3.2-8.4 7.1-14.3 13.4-20.6 6.3-6.3 12.2-10.1 20.6-13.4 6.3-2.5 15.8-5.4 33.2-6.2C202.6 109.5 208.2 109.3 256 109.3M256 77.1c-48.6 0-54.7 0.2-73.8 1.1 -19 0.9-32.1 3.9-43.4 8.3 -11.8 4.6-21.7 10.7-31.7 20.6 -9.9 9.9-16.1 19.9-20.6 31.7 -4.4 11.4-7.4 24.4-8.3 43.4 -0.9 19.1-1.1 25.2-1.1 73.8 0 48.6 0.2 54.7 1.1 73.8 0.9 19 3.9 32.1 8.3 43.4 4.6 11.8 10.7 21.7 20.6 31.7 9.9 9.9 19.9 16.1 31.7 20.6 11.4 4.4 24.4 7.4 43.4 8.3 19.1 0.9 25.2 1.1 73.8 1.1s54.7-0.2 73.8-1.1c19-0.9 32.1-3.9 43.4-8.3 11.8-4.6 21.7-10.7 31.7-20.6 9.9-9.9 16.1-19.9 20.6-31.7 4.4-11.4 7.4-24.4 8.3-43.4 0.9-19.1 1.1-25.2 1.1-73.8s-0.2-54.7-1.1-73.8c-0.9-19-3.9-32.1-8.3-43.4 -4.6-11.8-10.7-21.7-20.6-31.7 -9.9-9.9-19.9-16.1-31.7-20.6 -11.4-4.4-24.4-7.4-43.4-8.3C310.7 77.3 304.6 77.1 256 77.1L256 77.1z" />
                            <path d="M256 164.1c-50.7 0-91.9 41.1-91.9 91.9s41.1 91.9 91.9 91.9 91.9-41.1 91.9-91.9S306.7 164.1 256 164.1zM256 315.6c-32.9 0-59.6-26.7-59.6-59.6s26.7-59.6 59.6-59.6 59.6 26.7 59.6 59.6S288.9 315.6 256 315.6z" />
                            <circle cx="351.5" cy="160.5" r="21.5" />
                        </g>
                    </svg>
                    </a></li>
            <li><a href="https://www.last.fm/user/takitomouse" class="icon lastfm" title="Last.fm"><svg viewBox="0 0 512 512">
                        <path d="M230.104 336.568l-13.607-36.988c0 0-22.11 24.66-55.268 24.66 -29.341 0-50.172-25.512-50.172-66.328 0-52.293 26.359-71.001 52.297-71.001 37.412 0 49.316 24.234 59.522 55.273l13.607 42.518c13.603 41.236 39.113 74.402 112.666 74.402 52.727 0 88.437-16.155 88.437-58.672 0-34.438-19.56-52.297-56.125-60.802l-27.209-5.951c-18.707-4.252-24.233-11.906-24.233-24.659 0-14.456 11.478-22.96 30.189-22.96 20.406 0 31.458 7.653 33.162 25.935l42.516-5.103c-3.402-38.263-29.761-53.996-73.127-53.996 -38.266 0-75.68 14.456-75.68 60.799 0 28.912 14.029 47.197 49.315 55.697l28.916 6.801c21.683 5.104 28.908 14.031 28.908 26.363 0 15.73-15.305 22.107-44.218 22.107 -42.941 0-60.794-22.534-70.999-53.574l-14.032-42.513c-17.854-55.271-46.342-75.68-102.892-75.68 -62.499-0.001-95.663 39.538-95.663 106.715 0 64.628 33.164 99.489 92.689 99.489C207.141 359.1 230.104 336.568 230.104 336.568L230.104 336.568z" /></svg>
                    </a></li>
            <li><a href="https://uk.linkedin.com/in/martinchorley" class="icon linkedin" title="LinkedIn"><svg viewBox="0 0 512 512">
                        <path d="M186.4 142.4c0 19-15.3 34.5-34.2 34.5 -18.9 0-34.2-15.4-34.2-34.5 0-19 15.3-34.5 34.2-34.5C171.1 107.9 186.4 123.4 186.4 142.4zM181.4 201.3h-57.8V388.1h57.8V201.3zM273.8 201.3h-55.4V388.1h55.4c0 0 0-69.3 0-98 0-26.3 12.1-41.9 35.2-41.9 21.3 0 31.5 15 31.5 41.9 0 26.9 0 98 0 98h57.5c0 0 0-68.2 0-118.3 0-50-28.3-74.2-68-74.2 -39.6 0-56.3 30.9-56.3 30.9v-25.2H273.8z" /></svg>
                    </a></li>
        </ul>
    </div>


    <nav>
        <ul>|
            <li><a href="/">&nbsp;home</a>&nbsp;|</li>
            <li><a href="/blog">&nbsp;blog</a>&nbsp;|</li>
            <li><a href="/teaching">&nbsp;teaching</a>&nbsp;|</li>
            <li><a href="/research">&nbsp;research</a>&nbsp;|</li>
            <li><a href="/publications">&nbsp;publications</a>&nbsp;|</li>
        </ul>
    </nav>
</header><div id="content">
<main>
    

<ul class="pagination">
    
    <li class="page-item">
        <a href="/tags/python/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li class="page-item">
    <a href="/tags/python/" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/tags/python/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item active"><a class="page-link" href="/tags/python/page/2/">2</a></li>
    
    
    <li class="page-item disabled">
    <a href="" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li class="page-item">
        <a href="/tags/python/page/2/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>

    
    <article class="blogpost">
        <header>
            <h1> <a href="/2012/02/27/django-last.fm-authentication/">
                    Django &#43; Last.FM Authentication
                </a></h1>
            <p class="author">
                <span class="date">Monday, Feb 27, 2012</span>
            </p>
        </header>
        <div class="content">
            <p>Following a conversation with <a href="http://www.cs.cf.ac.uk/contactsandpeople/staffpage.php?emailname=J.A.Quinn">Jon</a> last week, I&rsquo;ve been having thoughts about playing around with Last.FM data again, having not looked at that <a href="http://www.last.fm/api/intro">API</a> for a couple of years. We had discussed the possibility of using the Last.FM web services as part of a project at a <a href="http://www.cs.cf.ac.uk/hackathon/">hackathon</a> that some of the undergraduates are running in a couple of weeks time, and since I&rsquo;ve moved from primarily developing using Java to mainly using Python since I last did anything with Last.FM I thought it would be useful to develop some basic python examples using the Last.FM API.</p>

<p>Yesterday I made a basic skeleton Django site that uses Last.FM for user authentication and includes a basic API wrapper for making queries. The code is all up on <a href="https://github.com/martinjc/djangoLastFMAuth">github</a> for those that are interested.</p>

        </div>
    </article>
    
    <article class="blogpost">
        <header>
            <h1> <a href="/2012/01/31/foursquare-category-icon-downloader-2/">
                    Foursquare Category Icon Downloader (2)
                </a></h1>
            <p class="author">
                <span class="date">Tuesday, Jan 31, 2012</span>
            </p>
        </header>
        <div class="content">
            <p><strong>UPDATE [01 August 2014]: Even more breaking! More recent version of the script <a href="/2014/08/01/foursquare-icon-downloading-yet-again/">here</a></strong></p>

<p>Someone commented recently that the <a href="/2011/10/01/colourful-foursquare-category-icons/">script I&rsquo;d written to download the Foursquare category icons</a> was broken. <a href="/img/{{ page.date | date: &quot;%Y-%m-%d&quot;}}-{{page.slug}}/downloader.py_1.txt">downloader.py</a> is an update that works as of today (notice the URL param with today&rsquo;s date) that will fetch all available sizes of all the category icons and store them in folders by size.</p>

        </div>
    </article>
    
    <article class="blogpost">
        <header>
            <h1> <a href="/2011/10/01/colourful-foursquare-category-icons/">
                    Colourful Foursquare category icons 
                </a></h1>
            <p class="author">
                <span class="date">Saturday, Oct 1, 2011</span>
            </p>
        </header>
        <div class="content">
            <p><strong>UPDATE [01 August 2014]: Even more breaking! More recent version of the script <a href="{{/2014/08/01/foursquare-icon-downloading-yet-again/">here</a></strong></p>

<p><strong>UPDATE 31/01/2011 - new version of the <a href="x/2012/01/31/foursquare-category-icon-downloader-2/">downloader</a> script is here</strong></p>

<p>A couple of projects I&rsquo;m working on at the moment need the ability to add foursquare venues to a map. This is pretty straightforward, but what is also needed is the ability to distinguish between the categories of the venues. To do this, I&rsquo;m adding custom markers to a google map at a venue location, with the marker having an icon representing the venue category.</p>

<p>Foursquare already have lots of category icons ready made, and they supply the urls in the <a href="https://developer.foursquare.com/docs/explore.html#req=venues/categories">/venues/category</a> endpoint, which is handy.  It seems from <a href="https://groups.google.com/forum/#!topic/foursquare-api/TsRBGdXDgzg">official responses</a> on the forum that they don&rsquo;t mind you downloading these icons for use in your apps, and they also supply the icons in <a href="https://groups.google.com/d/topic/foursquare-api/Pw0p4qqW79A/discussion">several sizes</a>, so hacking together a script to download all the available icons is pretty easy. The following python code will do just that - grab the latest category hierarchy from Foursquare, process it to extract all the category id&rsquo;s and icon locations, then download each icon in all available sizes:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> urllib2
<span style="color:#f92672">import</span> urllib
<span style="color:#f92672">import</span> json

<span style="color:#75715e"># supply oauth token as parameter</span>
params <span style="color:#f92672">=</span> {
    <span style="color:#e6db74">&#39;oauth_token&#39;</span> : <span style="color:#e6db74">&#39;VALID_FOURSQUARE_OAUTH_TOKEN&#39;</span>
}

api_base_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://api.foursquare.com/v2&#39;</span>

icons <span style="color:#f92672">=</span> {}

<span style="color:#75715e"># function to extract category info from json and</span>
<span style="color:#75715e"># process any sub-categories</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">process_category</span>( category_json ):
    icons[category_json[<span style="color:#e6db74">&#39;id&#39;</span>]] <span style="color:#f92672">=</span> category_json[<span style="color:#e6db74">&#39;icon&#39;</span>]

    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;categories&#39;</span> <span style="color:#f92672">in</span> category_json:
        [ process_category( c ) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> category_json[<span style="color:#e6db74">&#39;categories&#39;</span>] ]

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:

    url <span style="color:#f92672">=</span> api_base_url <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;/venues/categories?&#39;</span> <span style="color:#f92672">+</span> urllib<span style="color:#f92672">.</span>urlencode( params )

    <span style="color:#75715e"># try and retrieve the json</span>
    <span style="color:#66d9ef">try</span>:
        response <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>urlopen( url )
    <span style="color:#66d9ef">except</span> urllib2<span style="color:#f92672">.</span>HTTPError, e:
        <span style="color:#66d9ef">raise</span> e
    <span style="color:#66d9ef">except</span> urllib2<span style="color:#f92672">.</span>URLError, e:
        <span style="color:#66d9ef">raise</span> e

    <span style="color:#75715e"># read the json</span>
    raw_data <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>read( )
    py_data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads( raw_data )

    categories_json <span style="color:#f92672">=</span> py_data[<span style="color:#e6db74">&#39;response&#39;</span>]

    <span style="color:#75715e"># extract all the categories</span>
    <span style="color:#66d9ef">for</span> category <span style="color:#f92672">in</span> categories_json[<span style="color:#e6db74">&#39;categories&#39;</span>]:
        process_category( category )

    <span style="color:#75715e"># download all the icons</span>
    <span style="color:#66d9ef">for</span> foursq_id, icon <span style="color:#f92672">in</span> icons<span style="color:#f92672">.</span>iteritems( ):
        sizes <span style="color:#f92672">=</span> [ <span style="color:#e6db74">&#39;_32&#39;</span>, <span style="color:#e6db74">&#39;_64&#39;</span>, <span style="color:#e6db74">&#39;_256&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>]
        <span style="color:#66d9ef">for</span> size <span style="color:#f92672">in</span> sizes:
            <span style="color:#66d9ef">try</span>:
                url <span style="color:#f92672">=</span> icon<span style="color:#f92672">.</span>replace( <span style="color:#e6db74">&#39;.png&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">.png&#39;</span> <span style="color:#f92672">%</span> size )
                u <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>urlopen( url )
                file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s%s</span><span style="color:#e6db74">.png&#39;</span> <span style="color:#f92672">%</span> ( foursq_id, size )
                localFile <span style="color:#f92672">=</span> open( file_name, <span style="color:#e6db74">&#39;w&#39;</span> )
                localFile<span style="color:#f92672">.</span>write( u<span style="color:#f92672">.</span>read( ) )
                localFile<span style="color:#f92672">.</span>close( )
            <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span>:
                <span style="color:#66d9ef">pass</span></code></pre></div>

<p>After running this script, we have a local copy of all the category icons to use in our application downloaded. In my case, I need to be able to differentiate between venues within the categories, so it would be nice to have different coloured icons for my different classes of venue. Luckily this is also pretty simple. You&rsquo;ll need <a href="http://www.imagemagick.org/script/index.php">ImageMagick</a> installed, but if it is, the following code will go through all the greyscale icons downloaded with the previous script and convert them to whichever colours you like:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> os

<span style="color:#75715e">#</span>
<span style="color:#75715e"># colour name, and imagemagick colour name</span>
colours <span style="color:#f92672">=</span> {
    <span style="color:#e6db74">&#39;red&#39;</span> : <span style="color:#e6db74">&#39;red&#39;</span>,
    <span style="color:#e6db74">&#39;crimson&#39;</span> : <span style="color:#e6db74">&#39;crimson&#39;</span>,
    <span style="color:#e6db74">&#39;pink&#39;</span> : <span style="color:#e6db74">&#39;DeepPink&#39;</span>,
    <span style="color:#e6db74">&#39;purple&#39;</span> : <span style="color:#e6db74">&#39;purple&#39;</span>,
    <span style="color:#e6db74">&#39;indigo&#39;</span> : <span style="color:#e6db74">&#39;indigo&#39;</span>,
    <span style="color:#e6db74">&#39;blue&#39;</span> : <span style="color:#e6db74">&#39;blue&#39;</span>,
    <span style="color:#e6db74">&#39;navy&#39;</span> : <span style="color:#e6db74">&#39;navy&#39;</span>,
    <span style="color:#e6db74">&#39;turquoise&#39;</span> : <span style="color:#e6db74">&#39;turquoise1&#39;</span>,
    <span style="color:#e6db74">&#39;teal&#39;</span> : <span style="color:#e6db74">&#39;teal&#39;</span>,
    <span style="color:#e6db74">&#39;lime&#39;</span> : <span style="color:#e6db74">&#39;lime&#39;</span>,
    <span style="color:#e6db74">&#39;yellow&#39;</span> : <span style="color:#e6db74">&#39;yellow&#39;</span>,
    <span style="color:#e6db74">&#39;orange&#39;</span> : <span style="color:#e6db74">&#39;orange&#39;</span>,
}

<span style="color:#75715e">#</span>
<span style="color:#75715e"># list all the files in the current directory</span>
current_dir <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>getcwd( )
files <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>listdir( current_dir )

<span style="color:#75715e">#</span>
<span style="color:#75715e"># run through the file list</span>
<span style="color:#66d9ef">for</span> fname <span style="color:#f92672">in</span> files:
    <span style="color:#75715e"># for all the png&#39;s</span>
    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;.png&#39;</span> <span style="color:#f92672">in</span> fname:
        <span style="color:#75715e"># get the file name</span>
        stripped_name <span style="color:#f92672">=</span> fname[ :fname<span style="color:#f92672">.</span>rfind( <span style="color:#e6db74">&#39;.&#39;</span> ) ]
        <span style="color:#75715e"># convert to a new colour and save</span>
        <span style="color:#66d9ef">for</span> colour, magickcolour <span style="color:#f92672">in</span> colours<span style="color:#f92672">.</span>iteritems( ):
            colour_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">_</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">.png&#39;</span> <span style="color:#f92672">%</span> ( stripped_name, colour)
            os<span style="color:#f92672">.</span>system( <span style="color:#e6db74">&#39;convert </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> +level-colors </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">, </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span>
                        <span style="color:#f92672">%</span> ( fname, magickcolour, colour_name ) )</code></pre></div>

<p>The colour names come from <a href="http://www.imagemagick.org/script/color.php">this list</a> of imagemagick colours, you can obviously pick whichever colours you want. If you run this script in the directory with the downloaded Foursquare category icons, you&rsquo;ll end up with a multitude of differently sized, differently coloured icons.</p>

<p>And that&rsquo;s that. Later I&rsquo;ll post about how to use these as custom markers in a google map.</p>

<p>UPDATE 3/10/11:</p>

<p>As this example stores icons by category id, it actually duplicates some of the icons, which is un-necessary. This version  stores the icons by icon name, so saving the downloading and processing of around 100 duplicate icons. It also splits the different sizes into different directories for better file management.</p>

<p>UPDATE 5/10/11:</p>

<p>There&rsquo;s a change in the category json coming which will break this code. Use &ldquo;v=20111002&rdquo; as an extra parameter in the code that calls the Foursquare API and it&rsquo;ll keep working.</p>

        </div>
    </article>
    
    <article class="blogpost">
        <header>
            <h1> <a href="/2011/09/17/foursquare-hackathon-cardiff-day-1/">
                    Foursquare Hackathon Cardiff - Day 1
                </a></h1>
            <p class="author">
                <span class="date">Saturday, Sep 17, 2011</span>
            </p>
        </header>
        <div class="content">
            <p>I was fully intending to try and live-blog the progress of the foursquare hackathon today, even going as far as to install a live blog plugin, but things have been going very quickly and we&rsquo;ve been hitting the coding hard so I just haven&rsquo;t had time!</p>

<p>We&rsquo;ve managed to get a decent crowd in, a roughly 50:50 split of people we already knew from the School and other people from elsewhere. At the peak today we had fifteen people in, but at this stage we&rsquo;re down to ten - but those who have left are coming back tomorrow! There&rsquo;s an interesting mix of skills and knowledge levels and a number of people have come who are just eager to see how other people do things and to learn more about foursquare or coding in general. Luckily everyone is talkative and keen to get on and create something cool.</p>

<p>We started this morning at about 10am and managed to come up with a few ideas in a brief brainstorming session, eventually splitting ourselves into groups working on two ideas. The first idea is being driven forward by Vlad and is quite related to the work we&rsquo;re doing on Recognition - creating a system to pull in information on a venue or location and create a &lsquo;digest&rsquo; of what&rsquo;s relevant about the place. This could come in handy later on for our research. The second idea is a more &lsquo;fun&rsquo; idea - building a system for creating, managing and participating in pub crawls. There&rsquo;s a couple of parts to this: a management website that allows users to search foursquare venues and add them to a crawl, a backend that manages the storage and retrieval of users and crawls and an application front end that allows you to participate in the crawl itself. At this stage early on day one we&rsquo;ve got most of the backend built, and the management web app is coming along well. Tomorrow we&rsquo;re going to start the android app.</p>

        </div>
    </article>
    
    <article class="blogpost">
        <header>
            <h1> <a href="/2011/09/08/django-foursquare-oauth-webapp/">
                    Django &#43; Foursquare &#43; OAuth = webapp?
                </a></h1>
            <p class="author">
                <span class="date">Thursday, Sep 8, 2011</span>
            </p>
        </header>
        <div class="content">
            <p>Moving on from my fun with getting django + twitter + oauth to play nicely, it&rsquo;s now time to start writing a web app that uses foursquare as the authentication/login method. As part of this, I need a basic django framework for doing authentication with foursquare. This may be useful to someone else at some point (including me when I forget in three months time how I did things), so I&rsquo;ve written up the details and added the code to <a href="https://github.com/martinjc/DjangoFoursq">github</a>.</p>

<p>Firstly, you need to <a href="https://foursquare.com/oauth/">register an application</a> with Foursquare to get your Client ID and Client Secret. You can enter any name and website you want, but the callback url needs to be our local development machine (assuming that&rsquo;s where you&rsquo;re doing the development), and to be the callback url that we&rsquo;re going to specify in a minute:</p>










<figure>
    <img src="/2011/09/08/django-foursquare-oauth-webapp/Foursquare-Register-300x174.jpg" width="300" height="174" alt="Form to register an application">
    <figcaption>
        <small>
            Form to register an application
        </small>
    </figcaption>
</figure>

<p>The more observant will notice that the callback url is currently <a href="http://127.0.0.1/foursq_auth/callback/">http://127.0.0.1/foursq_auth/callback/</a>, but that the django web server actually runs on port 8000, so the url really needs to be <a href="http://127.0.0.1:8000/foursq_auth/callback/">http://127.0.0.1:8000/foursq_auth/callback/</a>. Unfortunately the form validation doesn&rsquo;t allow you to use a &lsquo;:&rsquo; in your callback url. However, once the consumer is registered you can edit the callback url, and the form for that doesn&rsquo;t validate the url (or does but doesn&rsquo;t moan about the colon). Eventually, you are looking for the consumer to be registered with a callback url like this:</p>










<figure>
    <img src="/2011/09/08/django-foursquare-oauth-webapp/CapturFiles-300x51.jpg" width="300" height="51" alt="">
    <figcaption>
        <small>
            
        </small>
    </figcaption>
</figure>

<p>Once that is registered, we can get on with writing the code. The basic premise is pretty simple, we need just five urls in our django app, five views to go with them, and two basic html pages, one for login, and one to show we are logged in. Assuming you have a django project started (for reference the one I&rsquo;m using here is called &lsquo;Dj4sq&rsquo;) we can start by creating our foursquare app:</p>

<pre><code>django-admin.py startapp foursq_auth
</code></pre>

<p>We then want to edit urls.py for our main django project to allow the new app to handle its own views:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">urlpatterns <span style="color:#f92672">=</span> patterns(<span style="color:#e6db74">&#39;&#39;</span>,
    (<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^foursq_auth/&#39;</span>, include(<span style="color:#e6db74">&#39;Dj4sq.foursq_auth.urls&#39;</span>)),
)</code></pre></div>

<p>and create and edit a file urls.py in the foursq_auth app with the five views we want:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">urlpatterns <span style="color:#f92672">=</span> patterns(<span style="color:#e6db74">&#39;foursq_auth.views&#39;</span>,
    <span style="color:#75715e"># main page redirects to start or login</span>
    url(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^$&#39;</span>, view<span style="color:#f92672">=</span>main, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;main&#39;</span>),
    <span style="color:#75715e"># receive OAuth token from 4sq</span>
    url(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^callback/$&#39;</span>, view<span style="color:#f92672">=</span>callback, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;oauth_return&#39;</span>),
    <span style="color:#75715e"># logout from the app</span>
    url(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^logout/$&#39;</span>, view<span style="color:#f92672">=</span>unauth, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;oauth_unauth&#39;</span>),
    <span style="color:#75715e"># authenticate with 4sq using OAuth</span>
    url(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^auth/$&#39;</span>, view<span style="color:#f92672">=</span>auth, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;oauth_auth&#39;</span>),
    <span style="color:#75715e"># main page once logged in</span>
    url( <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^done/$&#39;</span>, view<span style="color:#f92672">=</span>done, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;oauth_done&#39;</span> ),
)</code></pre></div>

<p>We then need our two basic html pages login.html and done.html:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">html</span>&gt;
    &lt;<span style="color:#f92672">head</span>&gt;
        &lt;<span style="color:#f92672">title</span>&gt;Foursquare OAuth Example&lt;/<span style="color:#f92672">title</span>&gt;
    &lt;/<span style="color:#f92672">head</span>&gt;
    &lt;<span style="color:#f92672">body</span>&gt;
    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;login&#34;</span>&gt;
        &lt;<span style="color:#f92672">p</span>&gt;Sign in with Foursquare to begin.&lt;/<span style="color:#f92672">p</span>&gt;
        &lt;<span style="color:#f92672">p</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;auth/&#34;</span>&gt;Login&lt;/<span style="color:#f92672">a</span>&gt;&lt;/<span style="color:#f92672">p</span>&gt;
    &lt;/<span style="color:#f92672">div</span>&gt;
    &lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
&lt;<span style="color:#f92672">html</span>&gt;
    &lt;<span style="color:#f92672">head</span>&gt;
        &lt;<span style="color:#f92672">title</span>&gt;Foursquare OAuth Example&lt;/<span style="color:#f92672">title</span>&gt;
    &lt;/<span style="color:#f92672">head</span>&gt;
    &lt;<span style="color:#f92672">body</span>&gt;
        &lt;<span style="color:#f92672">p</span>&gt;Hi {{ name }}, you&#39;ve successfully logged in! &lt;/<span style="color:#f92672">p</span>&gt;
	&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;../logout/&#34;</span>&gt;Logout&lt;/<span style="color:#f92672">a</span>&gt;
    &lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;</code></pre></div>

<p>All that&rsquo;s left after that is to write the views to tie it all together. We need a few variables defined for our code to work:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">CLIENT_ID <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;YOUR_CLIENT_ID&#39;</span>
CLIENT_SECRET <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;YOUR_CLIENT_SECRET&#39;</span>

request_token_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://foursquare.com/oauth2/authenticate&#39;</span>
access_token_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://foursquare.com/oauth2/access_token&#39;</span>
redirect_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://127.0.0.1:8000/foursq_auth/callback&#39;</span></code></pre></div>

<p>We can then write the views. The first one, &lsquo;main&rsquo; is super easy, as it only needs to return our login page:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>( request ):
    <span style="color:#66d9ef">return</span> render_to_response( <span style="color:#e6db74">&#39;foursq_auth/login.html&#39;</span> )</code></pre></div>

<p>The second, &lsquo;auth&rsquo;, is the first step in our authentication process, requesting an authorisation code from foursquare and redirecting the user to the page to authorise our app:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">auth</span>( request ):
    <span style="color:#75715e"># build the url to request</span>
    params <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;client_id&#39;</span> : CLIENT_ID,
            <span style="color:#e6db74">&#39;response_type&#39;</span> : <span style="color:#e6db74">&#39;code&#39;</span>,
            <span style="color:#e6db74">&#39;redirect_uri&#39;</span> : redirect_url }
    data <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>urlencode( params )
    <span style="color:#75715e"># redirect the user to the url to confirm access for the app</span>
    <span style="color:#66d9ef">return</span> HttpResponseRedirect(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">?</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (request_token_url, data))</code></pre></div>

<p>If the user accepts our app, they&rsquo;ll be re-directed to our callback url, and an authorisation code will be passed back as one of the parameters of the url, so the next view, &lsquo;callback&rsquo; needs to deal with this. It then needs to post a request to foursquare with the authorisation code in order to receive the access_token for the user:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># get the code returned from foursquare</span>
code <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>GET<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;code&#39;</span>)

<span style="color:#75715e"># build the url to request the access_token</span>
params <span style="color:#f92672">=</span> { <span style="color:#e6db74">&#39;client_id&#39;</span> : CLIENT_ID,
           <span style="color:#e6db74">&#39;client_secret&#39;</span> : CLIENT_SECRET,
           <span style="color:#e6db74">&#39;grant_type&#39;</span> : <span style="color:#e6db74">&#39;authorization_code&#39;</span>,
           <span style="color:#e6db74">&#39;redirect_uri&#39;</span> : redirect_url,
           <span style="color:#e6db74">&#39;code&#39;</span> : code}
data <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>urlencode( params )
req <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>Request( access_token_url, data )

<span style="color:#75715e"># request the access_token</span>
response <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>urlopen( req )
access_token <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads( response<span style="color:#f92672">.</span>read( ) )
access_token <span style="color:#f92672">=</span> access_token[<span style="color:#e6db74">&#39;access_token&#39;</span>]

<span style="color:#75715e"># store the access_token for later use</span>
request<span style="color:#f92672">.</span>session[<span style="color:#e6db74">&#39;access_token&#39;</span>] <span style="color:#f92672">=</span> access_token

<span style="color:#75715e"># redirect the user to show we&#39;re done</span>
<span style="color:#66d9ef">return</span> HttpResponseRedirect(reverse( <span style="color:#e6db74">&#39;oauth_done&#39;</span> ) )</code></pre></div>

<p>If we&rsquo;ve got the access token, we&rsquo;re all set. From now on we can make any calls to the Foursquare API that require authorisation, as long as we supply this token as a parameter to the request named &lsquo;oauth_token&rsquo;. To prove that we&rsquo;re logged in, we&rsquo;ll re-direct the user at the end of the callback to a &lsquo;done&rsquo; page, which will display some user details:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">done</span>( request ):
    <span style="color:#75715e"># get the access_token</span>
    access_token <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>session<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;access_token&#39;</span>)

    <span style="color:#75715e"># request user details from foursquare</span>
    params <span style="color:#f92672">=</span> { <span style="color:#e6db74">&#39;oauth_token&#39;</span> : access_token }
    data <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>urlencode( params )
    url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://api.foursquare.com/v2/users/self&#39;</span>
    full_url <span style="color:#f92672">=</span> url <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;?&#39;</span> <span style="color:#f92672">+</span> data
    <span style="color:#66d9ef">print</span> full_url
    response <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>urlopen( full_url )
    response <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>read( )
    user <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads( response )[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;user&#39;</span>]
    name <span style="color:#f92672">=</span> user[<span style="color:#e6db74">&#39;firstName&#39;</span>]

    <span style="color:#75715e"># show the page with the user&#39;s name to show they&#39;ve logged in</span>
    <span style="color:#66d9ef">return</span> render_to_response(<span style="color:#e6db74">&#39;foursq_auth/done.html&#39;</span>, {<span style="color:#e6db74">&#39;name&#39;</span>:name})</code></pre></div>

<p>And with that, we&rsquo;re all done. We can fire up the django server with:</p>

<pre><code>python manage.py runserver
</code></pre>

<p>open our browser to 127.0.0.1:8000/foursq_auth/ and go through the login process:</p>










<figure>
    <img src="/2011/09/08/django-foursquare-oauth-webapp/login-html-300x189.jpg" width="300" height="189" alt="Login Page">
    <figcaption>
        <small>
            Login Page
        </small>
    </figcaption>
</figure>










<figure>
    <img src="/2011/09/08/django-foursquare-oauth-webapp/foursquare-approval1-300x185.jpg" width="300" height="185" alt="Approving the app at Foursquare">
    <figcaption>
        <small>
            Approving the app at Foursquare
        </small>
    </figcaption>
</figure>










<figure>
    <img src="/2011/09/08/django-foursquare-oauth-webapp/done-html-300x189.jpg" width="300" height="189" alt="Successfully logged in">
    <figcaption>
        <small>
            Successfully logged in
        </small>
    </figcaption>
</figure>

<p>And that&rsquo;s that - A Django web app doing OAuth authentication with Foursquare. The full code is up on <a href="https://github.com/martinjc/DjangoFoursq">github</a> if you want to take a closer look.</p>

        </div>
    </article>
    
    <article class="blogpost">
        <header>
            <h1> <a href="/2011/06/09/logging-in-to-websites-with-python/">
                    Logging in to websites with python
                </a></h1>
            <p class="author">
                <span class="date">Thursday, Jun 9, 2011</span>
            </p>
        </header>
        <div class="content">
            <p>As <a href="http://users.cs.cf.ac.uk/M.J.Chorley/2011/06/09/scraping-myfitnesspal-dat/">previously explained</a>, I needed a python script to login to a website so I could access data. There&rsquo;s loads of examples out on the web of how to do this, my solution (mashed together from many examples) is described below. For the whole script, jump to the end.</p>

<p>Firstly, we need to set some simple variables about the website we&rsquo;re trying to log in to. Obviously, I&rsquo;m trying to login to myfitnesspal, but this process should work with most websites that use a simple form + cookie based login process. We need to set the url we are trying to access, where to post the login information to, and a file to store cookies in:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># url for website        </span>
base_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://www.myfitnesspal.com&#39;</span>       
<span style="color:#75715e"># login action we want to post data to       </span>
login_action <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/account/login&#39;</span>       
<span style="color:#75715e"># file for storing cookies       </span>
cookie_file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;mfp.cookies&#39;</span></code></pre></div>
Then we need to setup our cookie storage, and url opener. We want the opener to be able to handle cookies and redirects:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> urllib<span style="color:#f92672">,</span> urllib2
<span style="color:#f92672">import</span> cookielib

<span style="color:#75715e"># set up a cookie jar to store cookies</span>
cj <span style="color:#f92672">=</span> cookielib<span style="color:#f92672">.</span>MozillaCookieJar(cookie_file)

<span style="color:#75715e"># set up opener to handle cookies, redirects etc</span>
self<span style="color:#f92672">.</span>opener <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>build_opener(
     urllib2<span style="color:#f92672">.</span>HTTPRedirectHandler(),
     urllib2<span style="color:#f92672">.</span>HTTPHandler(debuglevel<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>),
     urllib2<span style="color:#f92672">.</span>HTTPSHandler(debuglevel<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>),            
     urllib2<span style="color:#f92672">.</span>HTTPCookieProcessor(cj)
)
<span style="color:#75715e"># pretend we&#39;re a web browser and not a python script</span>
opener<span style="color:#f92672">.</span>addheaders <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;User-agent&#39;</span>,
    (<span style="color:#e6db74">&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_7) &#39;</span>
     <span style="color:#e6db74">&#39;AppleWebKit/535.1 (KHTML, like Gecko) &#39;</span>
     <span style="color:#e6db74">&#39;Chrome/13.0.782.13 Safari/535.1&#39;</span>))
]</code></pre></div>
Next we need to open the front page of the website once to set any initial tracking cookies:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># open the front page of the website to set</span>
<span style="color:#75715e"># and save initial cookies</span>
response <span style="color:#f92672">=</span> opener<span style="color:#f92672">.</span>open(base_url)
cj<span style="color:#f92672">.</span>save()<span style="color:#f92672">&lt;/</span>pre<span style="color:#f92672">&gt;</span>
Then <span style="color:#66d9ef">finally</span> we can call the login action <span style="color:#66d9ef">with</span> our username <span style="color:#f92672">and</span> password <span style="color:#f92672">and</span> login to the website:
<span style="color:#f92672">&lt;</span>pre<span style="color:#f92672">&gt;</span><span style="color:#75715e"># parameters for login action</span>
login_data <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>urlencode({
    <span style="color:#e6db74">&#39;username&#39;</span> : <span style="color:#e6db74">&#39;my_username&#39;</span>,
    <span style="color:#e6db74">&#39;password&#39;</span> : <span style="color:#e6db74">&#39;my_password&#39;</span>,
    <span style="color:#e6db74">&#39;remember_me&#39;</span> : True
})
<span style="color:#75715e"># construct the url</span>
login_url <span style="color:#f92672">=</span> base_url <span style="color:#f92672">+</span> login_action
<span style="color:#75715e"># then open it</span>
response <span style="color:#f92672">=</span> opener<span style="color:#f92672">.</span>open(login_url, login_data)
<span style="color:#75715e"># save the cookies and return the response       </span>
cj<span style="color:#f92672">.</span>save()</code></pre></div>
The parameters for the POST request (and the action to POST to) can usually be found by examining the source of the login page.</p>

<p>There you have it - you should now be logged into the website and can access any pages that the logged in user can normally access through a web browser. Any calls using the &lsquo;opener&rsquo; created above will present the right cookies for the logged in user. The cookies are saved to file, so next time you run the script you can check for cookies, try and use them, and only re-login if that doesn&rsquo;t work.</p>

<p>My full version is <a href="http://martinchorley.com/img/{{ page.date | date: &quot;%Y-%m-%d&quot;}}-{{page.slug}}/web_login.py_2.txt">attached</a> to this post, it&rsquo;s under a <a href="http://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a> license, so feel free to use it for whatever.</p>

<p>Quite how this will cope when websites catch up to the new EU cookie legislation is anyone&rsquo;s guess. My guess is it won&rsquo;t.</p>

        </div>
    </article>
    
    <article class="blogpost">
        <header>
            <h1> <a href="/2011/04/04/django-tweepy-oauth/">
                    Django &#43; Tweepy &#43; OAuth
                </a></h1>
            <p class="author">
                <span class="date">Monday, Apr 4, 2011</span>
            </p>
        </header>
        <div class="content">
            <p>There is a lot of information out there that talks about putting Django and Tweepy together to make a Twitter web app. I read a lot of it recently, and although a lot of it is helpful some of it can be quite complicated or out of date.</p>

<p>To make things simple, I thought I&rsquo;d create an example Django project that just contains the basics needed to get up and running.</p>

<p>The &lsquo;DjangoTweepy&rsquo; project, hosted on <a href="https://github.com/martinjc/DjangoTweepy">Github here</a> contains all the code needed to get up and running with a Twitter web app using Django and Tweepy. Download it and follow the instructions to get up and running quickly, or with a bit of hacking add the &lsquo;twitter_auth&rsquo; app to your existing projects.</p>

        </div>
    </article>
    
    <article class="blogpost">
        <header>
            <h1> <a href="/2011/04/04/twitter-wordle/">
                    Twitter Wordle
                </a></h1>
            <p class="author">
                <span class="date">Monday, Apr 4, 2011</span>
            </p>
        </header>
        <div class="content">
            <p>Next week we have the project partners coming over to Cardiff for a workshop. Stu and myself were discussing that we should have some way to display information throughout the day, something that makes it easy to pick out the main themes of talks etc. I&rsquo;m a big fan of the <a href="http://www.wordle.net/">Wordle</a> as a way of displaying text, so we thought it would be nice if we could have a dynamic Wordle displayed that people could add to throughout the workshop.</p>

<p>I found a python library called <a href="https://github.com/atizo/PyTagCloud">pyTagCloud</a> that will turn text into wordle-like tag clouds either as images or as html. As I <a href="http://users.cs.cf.ac.uk/M.J.Chorley/2011/03/28/fun-with-django/">mentioned previously</a> I already have a django based project on the go which interfaces with twitter, so I already had code written that uses <a href="https://github.com/joshthecoder/tweepy">Tweepy</a> to OAuth with twitter and do a search for keywords. Combining the two, I get an app that will continually search twitter for a given keyword, extract the text from all the tweets and display a wordle along with the latest tweets. People can contribute to the display by tweeting with a given hash tag, and as long as we search for that hash tag, their opinions and notes will be displayed.</p>

<p>For instance, here&rsquo;s the display running with one of today&rsquo;s trending topics: &lsquo;Alan Titchmarsh&rsquo;:</p>










<figure>
    <img src="/2011/04/04/twitter-wordle/tweets12-300x182.png" width="300" height="182" alt="">
    <figcaption>
        <small>
            
        </small>
    </figcaption>
</figure>

<p>It&rsquo;s not entirely perfect, I need to do some more filtering on the text to remove some words that aren&rsquo;t removed by the stop word filtering that pyTagCloud does such as &lsquo;rt&rsquo;, &lsquo;http&rsquo;, &lsquo;bit&rsquo;, &lsquo;ly&rsquo; and so on. It would also be good to remove things that aren&rsquo;t words, like &lsquo;xxxxxx&rsquo;. I&rsquo;ve been looking at the <a href="http://www.nltk.org/">Natural Language Toolkit</a> for a couple of days for the other project, so I&rsquo;ll probably re-use some of that code here too.</p>

<p>The only problem now is that I&rsquo;m probably going to be the only person at the workshop tweeting&hellip;</p>

        </div>
    </article>
    
    <article class="blogpost">
        <header>
            <h1> <a href="/2011/03/28/fun-with-django.../">
                    fun with django...
                </a></h1>
            <p class="author">
                <span class="date">Monday, Mar 28, 2011</span>
            </p>
        </header>
        <div class="content">
            <p>One of the latest ideas we are working on for the new project is looking at how providing different amounts of information affects our perception of content.  Even in pure implementation terms this is interestingly unlike any of the work I&rsquo;ve done in the last few years, most of which was simulation based. &ldquo;<em>Code a simulation, run the simulation, analyse the results</em>&rdquo; has been a pattern of work since the beginning of my PhD and beyond. This recent idea however needs us to essentially survey a large number of people, so rather than just coding some command-line simulation in C/C++ (or god-forbid, Fortran) that only one or two people might use, I&rsquo;m building a web based system that (hopefully) will have many hundreds of people interact with it.</p>

<p>From the fact that this website is just a basic wordpress install with very few changes to the default theme you can probably tell that I am not a web developer. In the recent past I&rsquo;ve very rarely had any call to do anything web-based beyond just keeping a personal (static HTML + CSS) home page up to date here at the school. To suddenly move into building a dynamic website that does a lot of complicated database stuff and interfaces with other services via OAuth is quite a jump. Fortunately, it&rsquo;s been a relatively easy jump thanks to <a href="http://www.djangoproject.com/">django</a>.</p>

<p>I&rsquo;m not going to ramble on about what django is (basically a python web framework), if you haven&rsquo;t heard of it go check it out. What I am going to do is recommend it highly. It is so simple, so quick and so powerful that implementing a web project with it is dreamy. We first discussed this research idea sometime at the beginning of the month, and I started coding it sometime around the 16th. Since then I&rsquo;ve actually spent a week working on another project (and the ever present SocialNets deliverables for the EU), but I&rsquo;m still massively into implementation to the point where I&rsquo;m confident of having a site ready to beta test this week. Which I think is pretty good going for someone with as little web programming skill as I have!</p>

<p>So, there. Django. Try it out, it&rsquo;s aces.</p>

<p>p.s - the project will hopefully be open to the public at some point in the future, once it is, I&rsquo;ll post here.</p>

        </div>
    </article>
    
    

<ul class="pagination">
    
    <li class="page-item">
        <a href="/tags/python/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li class="page-item">
    <a href="/tags/python/" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/tags/python/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item active"><a class="page-link" href="/tags/python/page/2/">2</a></li>
    
    
    <li class="page-item disabled">
    <a href="" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li class="page-item">
        <a href="/tags/python/page/2/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>

</main>

    </div><script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-25500481-1', 'auto');
    ga('send', 'pageview');

</script>
<script>window.twttr = (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0],
            t = window.twttr || {};
        if (d.getElementById(id)) return t;
        js = d.createElement(s);
        js.id = id;
        js.src = "https://platform.twitter.com/widgets.js";
        fjs.parentNode.insertBefore(js, fjs);

        t._e = [];
        t.ready = function (f) {
            t._e.push(f);
        };

        return t;
    }(document, "script", "twitter-wjs"));
</script></body>

</html>